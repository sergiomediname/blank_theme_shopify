<div class="product">
  <h1>{{ currency }}</h1>
  <h1>{{ shop.currency }}</h1>

  <div class="container">
    <!-- Product.liquid v0.1 -->
    <div class="grid grid-cols cols-2">
      <!-- product-images -->
      <div class="product__gallery">
        {% for image in product.images %}

          {% if forloop.first %}

            <div id="first-image">
              <a href="{{ image | product_img_url: 'large' }}" title="{{ product.title }}"><img src="{{ image | product_img_url: 'medium' }}" alt="{{ product.title | escape }}" /></a>
            </div>

          {% else %}

            <div class="product-images">
              <a href="{{ image | product_img_url: 'large' }}" title="{{ product.title }}"><img src="{{ image | product_img_url: 'small' }}" alt="{{ product.title | escape }}" /></a>
            </div>

          {% endif %}

        {% endfor %}
      </div>
      <!-- product-details -->
      <div id="product__details">
        <h1 class="text-center">{{ product.title }}</h1>
        <div>{{ product.price }}</div>
        {{ product.description }}
        {% if product.available %}
          <form action="/cart/add" method="post">
            <div id="product-variants">
              <select id="product-select" name='id'>
                {% for variant in product.variants %}
                  <option value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
                {% endfor %}
              </select>
            </div>
            <!-- product-variants -->
            <input
              type="submit"
              value="Add to cart"
              id="addtocart" />
          </form>
        {% else %}
          Sorry, the product is not available
        {% endif %}
      </div>
    </div>


    <div id="product-alternative">
      <h3>Like what you see?</h3>
      Browse more {{ 'products like this' | link_to_type }} or more products by {{ product.vendor | link_to_vendor }}.
    </div>
    <!-- product alternative -->
  </div>
</div>

<script>
  console.log('{{ currency }}');
  window.addEventListener("DOMContentLoaded", async () => {
    const data = await ShopifyBlank.getProductData('{{ product.handle }}');

    const variants = document.getElementById("product-select");

    variants.addEventListener("change", function(selected) {
      const current_variant = data.variants.filter((variant) => variant.id.toString() === selected.target.value);
      console.log(current_variant[0].price);

      document.querySelector("#product__details h1").innerHTML = current_variant[0].price;
    });
  });
</script>